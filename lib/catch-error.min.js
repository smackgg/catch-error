!function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define("CatchError",[],o):"object"==typeof exports?exports.CatchError=o():e.CatchError=o()}(this,function(){return function(e){function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}var t={};return o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},o.p="",o(o.s=0)}([function(e,o,t){"use strict";function r(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var n=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},s=t(1),i={cdn:"https://res.wx.qq.com/mmbizwap/zh_CN/htmledition/js/vconsole/3.0.0/vconsole.min.js",method:"post",showDevtools:!1,urlSwitch:{devtools:"show"}},a=function e(){var o=this;r(this,e),this.init=function(e){o.config=n({},i,e),o.cacheLog();var t=o.config,r=t.showDevtools,s=t.urlSwitch,a=Object.keys(s).reduce(function(e,o){return new RegExp(o+"="+s[o]).test(window.location.search)||e},!1);return r||a?o.show():Promise.resolve()},this.show=function(){return o.vConsole?Promise.resolve(o.vConsole):(0,s.loadScript)(o.config.cdn).then(function(){return o.initVConsole()})},this.cacheLog=function(){o.methodList.forEach(function(e){o.method[e]=console[e],console[e]=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];o.store.push({logType:e,logs:r}),o.method[e].apply(console,r)}}),window.onerror=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.store.push({logType:"error",logs:t}),o.onerror.apply(o,t)},window.addEventListener("unhandledrejection",o.logRejectMessage)},this.initVConsole=function(){return o.vConsole=new window.VConsole,o.store.forEach(function(e){o.vConsole.pluginList.default.printLog({logType:e.logType,logs:e.logs})}),o.config.url&&(window.onerror&&(o.windowOnError=window.onerror),window.onerror=o.onerror),Promise.resolve(o.vConsole)},this.logRejectMessage=function(e){var t=e.reason,r=t.message,n=t.sourceUrl,s=t.line,i=t.column;o.store.push({logType:"error",logs:[r]}),r.indexOf("请求错误(UploadLogsError)")>=0||o.onerror(r,n,s,i,e.reason)},this.onerror=function(e,t,r,i,a){if(o.config.url){o.windowOnError&&o.windowOnError(e,t,r,i,a);var c=e;a&&a.stack&&(c=(0,s.processStackMsg)(a)),(0,s.isOBJByType)(c,"Event")&&(c+=c.type?"--"+c.type+"--"+(c.target?c.target.tagName+"::"+c.target.src:""):""),c=(""+c||"").substr(0,500);var u=n({msg:c,timestamp:Date.now(),userAgent:window.navigator.userAgent,targetUrl:t,line:r,col:i},o.config.extendFields);(0,s.ajax)({method:o.config.method,url:o.config.url,data:u})}},this.store=[],this.methodList=["log","warn","info","debug","error"],this.method={},this.vConsole=null};o.default=a},function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});o.ajax=function(e){var o=e.url,t=e.data,r=e.method,n=void 0===r?"post":r;return new Promise(function(e,r){var s=new XMLHttpRequest;s.onreadystatechange=function(){4===s.readyState&&(s.status>=200&&s.status<300||304===s.status?e(s.responseText,s.status,s):r(new Error("请求错误(UploadLogsError): "+o+" "+s.status+" "+s.statusText)))},"get"===n&&(s.open(n,"url"+(/\?/.test(o)?"&":"?")+"msg="+encodeURIComponent(t.msg),!0),s.send(null)),"post"===n&&(s.open(n,o,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(JSON.stringify(t)))})},o.loadScript=function(e){return new Promise(function(o){var t=document.createElement("script");t.type="text/javascript",t.src=e,t.setAttribute("crossorigin","anonymous"),t.crossorigin="anonymous";var r=function(){t.readyState&&"complete"!==t.readyState||o()};t.onload=r,t.onreadystatechange=r;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)})},o.processStackMsg=function(e){var o=e.stack.replace(/\n/gi,"").split(/\bat\b/).slice(0,9).join("@").replace(/\?[^:]+/gi,""),t=e.toString();return o.indexOf(t)<0&&(o=t+"@"+o),o},o.isOBJByType=function(e,o){return Object.prototype.toString.call(e)==="[object "+(o||"Object")+"]"}}])});