{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 690ad4d4e8227165629d","webpack:///./index.js","webpack:///./ajax.js"],"names":["defaultConfig","method","url","processStackMsg","error","stack","replace","split","slice","join","msg","toString","indexOf","isOBJByType","o","type","Object","prototype","call","CatchError","onerror","line","col","newMsg","target","tagName","src","substr","logs","timestamp","Date","now","userAgent","window","navigator","targetUrl","config","data","ajax","Promise","resolve","reject","xhr","XMLHttpRequest","onreadystatechange","readyState","status","responseText","Error","statusText","open","send","setRequestHeader","JSON","stringify"],"mappings":"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","file":"catch-error.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"CatchError\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"CatchError\"] = factory();\n\telse\n\t\troot[\"CatchError\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 690ad4d4e8227165629d","import ajax from './ajax';\n\nconst defaultConfig = {\n  method: 'post',\n  url: '/error',\n};\n\nfunction processStackMsg(error) {\n  let stack = error.stack\n    .replace(/\\n/gi, '')\n    .split(/\\bat\\b/)\n    .slice(0, 9)\n    .join('@')\n    .replace(/\\?[^:]+/gi, '');\n  const msg = error.toString();\n  if (stack.indexOf(msg) < 0) {\n    stack = `${msg}@${stack}`;\n  }\n  return stack;\n}\n\nfunction isOBJByType(o, type) {\n  return Object.prototype.toString.call(o) === `[object ${type || 'Object'}]`;\n}\n\nclass CatchError {\n  init(config) {\n    this.config = Object.assign(defaultConfig, config);\n    window.onerror = this.onerror;\n  }\n  onerror = (msg, url, line, col, error) => {\n    let newMsg = msg;\n\n    if (error && error.stack) {\n      newMsg = processStackMsg(error);\n    }\n\n    if (isOBJByType(newMsg, 'Event')) {\n      newMsg += newMsg.type ?\n        (`--${newMsg.type}--${newMsg.target ?\n          (`${newMsg.target.tagName}::${newMsg.target.src}`) : ''}`) : '';\n    }\n\n    newMsg = (`${newMsg}` || '').substr(0, 500);\n    const logs = {\n      msg: newMsg,\n      timestamp: Date.now(),\n      userAgent: window.navigator.userAgent,\n      targetUrl: url,\n      line,\n      col,\n    };\n\n    // upload error\n    ajax({\n      method: this.config.method,\n      url: this.config.url,\n      data: logs,\n    });\n  }\n}\n\nexport default CatchError;\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","export default function ajax({ url, data, method = 'post' }) {\n  return new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest();\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState === 4) {\n        if ((xhr.status >= 200 && xhr.status < 300) || xhr.status === 304) {\n          resolve(xhr.responseText, xhr.status, xhr);\n        } else {\n          reject(new Error(`请求错误: ${xhr.status} ${xhr.statusText}`));\n        }\n      }\n    };\n    if (method === 'get') {\n      xhr.open(method, url, true);\n      xhr.send(null);\n    }\n    if (method === 'post') {\n      xhr.open(method, url, true);\n      xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n      xhr.send(JSON.stringify(data));\n    }\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./ajax.js"],"sourceRoot":""}